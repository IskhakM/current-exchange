# USD Exchange Rate Service

## Описание
Сервис на Django для получения актуального курса USD/RUB и истории запросов. Курс обновляется не чаще одного раза в 10 секунд.

## Быстрый запуск
```bash
git clone <repo_url>
cd current_exchange
cp .env.example .env  # создаем конфиг из шаблона
docker-compose up --build
docker-compose exec backend python manage.py migrate
```
Откройте: http://localhost:8000/get-current-usd/

## Подробная установка
1. Клонирование и настройка окружения
```bash
git clone <repo_url>
cd current_exchange
```
2. Настройка переменных окружения
Создайте файл .env на основе шаблона:

```bash
cp .env.example .env
```
Отредактируйте .env при необходимости:

```env

SECRET_KEY=ваш-секретный-ключ  
DEBUG=False                     

POSTGRES_DB=exchange_db
POSTGRES_USER=exchange_user
POSTGRES_PASSWORD=ваш_пароль

CBR_API_URL=https://www.cbr-xml-daily.ru/daily_json.js
```
3. Запуск через Docker
```bash
# Сборка и запуск
docker-compose up --build

# Миграции (в отдельном терминале или после запуска)
docker-compose exec backend python manage.py migrate

# Опционально: создание суперпользователя
docker-compose exec backend python manage.py createsuperuser
```
4. Запуск без Docker (локально)
```bash
# Создайте виртуальное окружение
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# Установите зависимости
pip install -r requirements.txt

# Настройте БД (требуется установленный PostgreSQL)
# Отредактируйте .env: DB_HOST=localhost

# Миграции и запуск
python manage.py migrate
python manage.py runserver
```
## API Endpoint
GET /get-current-usd/

Ответ:

```json
{
  "usd_current": "96.1234",
  "latest_10_requests": [
    {
      "rate": "96.1234",
      "created_at": "2024-01-20T10:00:00Z"
    }
  ],
  "updated_at": "2024-01-20T10:00:00Z"
}
```
## Логика работы
Проверка актуальности: Последняя запись в БД проверяется на свежесть

Обновление данных: Если прошло >10 секунд, запрашивается новый курс с API ЦБ

Кэширование: Курс не обновляется чаще 1 раза в 10 секунд

История: Возвращаются последние 10 записей

## Технологии
Python 3.11

Django 4.2

Django REST Framework

PostgreSQL

Docker / Docker Compose

## Вопросы к команде
### Продакт-менеджеру
Какой источник курса считается эталонным?

Допустима ли задержка обновления данных?

Планируется ли использование endpoint внешними клиентами?

Нужны ли уведомления при резких изменениях курса?

### Team Lead
Используется ли в проекте Redis/Celery?

Какие требования к покрытию тестами?

Есть ли стандарты логирования и обработки ошибок?

Какой лимит запросов к внешнему API?

## Тайминги

### Первичная оценка:
| Компонент | Оценка |
|-----------|--------|
| Настройка проекта | 1 час |
| Модели и миграции | 30 мин |
| API View и логика | 1 час |
| Docker конфигурация | 1 час |
| Документация | 30 мин |
| Тестирование | 1 час |
| **Итого** | **~5 часов** |

### Фактическое время выполнения:
**Начало:** 22 января 2026, 14:13 (UTC+6 / МСК+3)  
**Завершение:** 22 января 2026, ~18:00 (UTC+6 / МСК+3)  
**Общее время:** ~3 часа 45 минут

*Примечание: время указано по часовому поясу Бишкека (UTC+6). Для Москвы (МСК) добавьте +3 часа.*

#### Распределение по задачам:
1. **14:13 - 15:30** (~1 час 15 мин)  
   - Настройка Django проекта
   - Модели, миграции, сериализаторы
   - Базовая логика API

2. **15:30 - 16:45** (~1 час 15 мин)  
   - Реализация логики обновления курса
   - Интеграция с API ЦБ
   - Обработка ошибок и рефакторинг

3. **16:45 - 18:00** (~1 час 15 мин)  
   - Docker конфигурация
   - Документация (README)
   - Финальное тестирование и отладка

#### Итог:
- **Оценка:** 5 часов  
- **Фактически:** 3 часа 45 минут  
- **Эффективность:** ~75% от оценки